<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Join: Merge sections (horizontally) from the Mask or Cluster step &mdash; seismic-rna  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon-32x32.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Table: Count mutations for each read and position" href="table.html" />
    <link rel="prev" title="Cluster: Infer alternative structures by clustering reads’ mutations" href="cluster.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            seismic-rna
              <img src="../../_static/logo-200.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/index.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../steps/index.html">Step-By-Step</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">How To</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Run SEISMIC-RNA</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="demult.html">Demultiplex: Split multiplexed FASTQ files by their barcodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="align.html">Align: Trim FASTQ files and align them to reference sequences</a></li>
<li class="toctree-l3"><a class="reference internal" href="relate.html">Relate: Compute relationships between references and aligned reads</a></li>
<li class="toctree-l3"><a class="reference internal" href="pool.html">Pool: Merge samples (vertically) from the Relate step</a></li>
<li class="toctree-l3"><a class="reference internal" href="mask.html">Mask: Define mutations and sections to filter reads and positions</a></li>
<li class="toctree-l3"><a class="reference internal" href="cluster.html">Cluster: Infer alternative structures by clustering reads’ mutations</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Join: Merge sections (horizontally) from the Mask or Cluster step</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#join-input-files">Join: Input files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#join-settings">Join: Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#join-output-files">Join: Output files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#join-troubleshoot-and-optimize">Join: Troubleshoot and optimize</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="table.html">Table: Count mutations for each read and position</a></li>
<li class="toctree-l3"><a class="reference internal" href="fold.html">Fold: Predict RNA secondary structures using mutation rates</a></li>
<li class="toctree-l3"><a class="reference internal" href="graph.html">Graph: Plot data from tables and/or structures and compare samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="export.html">Export: Export a file of each sample for the seismic-graph web app</a></li>
<li class="toctree-l3"><a class="reference internal" href="wf.html">Workflow: Run all steps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../graph/index.html">Graph Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lists.html">List Positions Matching Criteria</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adjclust.html">Add/Delete Orders to/from an Already-Clustered Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cleanfa.html">Clean FASTA Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../inputs.html">List Input Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sections.html">Define Sections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../normalize.html">Normalize Mutation Rates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parallel.html">Parallelize Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging.html">Log Messages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cli.html">Commands, Arguments, Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/seismicrna.html">seismicrna package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../formats/index.html">File Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data/index.html">Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../algos/index.html">Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../issues.html">Bugs and Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../writeme.html">How to Write this Manual</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">seismic-rna</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">How To</a></li>
          <li class="breadcrumb-item"><a href="index.html">Run SEISMIC-RNA</a></li>
      <li class="breadcrumb-item active">Join: Merge sections (horizontally) from the Mask or Cluster step</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/howto/run/join.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="join-merge-sections-horizontally-from-the-mask-or-cluster-step">
<h1>Join: Merge sections (horizontally) from the Mask or Cluster step<a class="headerlink" href="#join-merge-sections-horizontally-from-the-mask-or-cluster-step" title="Permalink to this headline"></a></h1>
<section id="join-input-files">
<h2>Join: Input files<a class="headerlink" href="#join-input-files" title="Permalink to this headline"></a></h2>
<section id="join-input-file-mask-cluster-join-report">
<h3>Join input file: Mask/Cluster/Join report<a class="headerlink" href="#join-input-file-mask-cluster-join-report" title="Permalink to this headline"></a></h3>
<p>You can give any number of Mask or Cluster reports as inputs for the Join step.
You can also give Join report files, to join sections that were themselves made
by joining other sections.
See <a class="reference internal" href="../inputs.html"><span class="doc">List Input Files</span></a> for ways to list multiple files.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>SEISMIC-RNA will not double-count any of your original sections, even if
they appear in multiple report files you are joining.
It will just log a warning if it finds any sections given multiple times.</p>
</div>
<p>Mask, Cluster, and Join reports will be joined only if they share all of</p>
<ul class="simple">
<li><p>the top-level output directory, i.e. <code class="docutils literal notranslate"><span class="pre">--out-dir</span></code> (<code class="docutils literal notranslate"><span class="pre">-o</span></code>)</p></li>
<li><p>the sample</p></li>
<li><p>the reference</p></li>
<li><p>whether they are clustered (i.e. sections from Mask will not be joined with
sections from Cluster)</p></li>
</ul>
<p>For each combination of these attributes, SEISMIC-RNA will produce a joined
section from all Mask/Cluster/Join reports with those attributes.
The original Mask/Cluster/Join report files will not be deleted or modified;
you will merely get a new Join report file for each joined section.</p>
<p>For example, if you ran the command</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">seismic</span> <span class="n">join</span> <span class="o">-</span><span class="n">J</span> <span class="p">{</span><span class="n">joined</span><span class="p">}</span> <span class="p">{</span><span class="n">out</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">sample</span><span class="p">}</span><span class="o">/</span><span class="n">cluster</span><span class="o">/</span><span class="n">ref</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sect</span><span class="o">-</span><span class="mi">1</span> <span class="p">{</span><span class="n">out</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">sample</span><span class="p">}</span><span class="o">/</span><span class="n">cluster</span><span class="o">/</span><span class="n">ref</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sect</span><span class="o">-</span><span class="mi">2</span> <span class="p">{</span><span class="n">out</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">sample</span><span class="p">}</span><span class="o">/</span><span class="n">mask</span><span class="o">/</span><span class="n">ref</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sect</span><span class="o">-</span><span class="mi">1</span> <span class="p">{</span><span class="n">out</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">sample</span><span class="p">}</span><span class="o">/</span><span class="n">mask</span><span class="o">/</span><span class="n">ref</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sect</span><span class="o">-</span><span class="mi">2</span> <span class="p">{</span><span class="n">out</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">sample</span><span class="p">}</span><span class="o">/</span><span class="n">mask</span><span class="o">/</span><span class="n">ref</span><span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="n">sect</span><span class="o">-</span><span class="mi">1</span> <span class="p">{</span><span class="n">out</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">sample</span><span class="p">}</span><span class="o">/</span><span class="n">mask</span><span class="o">/</span><span class="n">ref</span><span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="n">sect</span><span class="o">-</span><span class="mi">2</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">{out}</span></code> is the path of your output directory and <code class="docutils literal notranslate"><span class="pre">{joined}</span></code> is the
name you want to give to each joined section, then you would get three new Join
reports representing the joined sections:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">{out}/{sample}/cluster/ref-1/{joined}/cluster-report.json</span></code>: made from
<code class="docutils literal notranslate"><span class="pre">{out}/{sample}/cluster/ref-1/sect-1/cluster-report.json</span></code> and
<code class="docutils literal notranslate"><span class="pre">{out}/{sample}/cluster/ref-1/sect-2/cluster-report.json</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{out}/{sample}/mask/ref-1/{joined}/mask-report.json</span></code>: made from
<code class="docutils literal notranslate"><span class="pre">{out}/{sample}/mask/ref-1/sect-1/mask-report.json</span></code> and
<code class="docutils literal notranslate"><span class="pre">{out}/{sample}/mask/ref-1/sect-2/mask-report.json</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{out}/{sample}/mask/ref-2/{joined}/mask-report.json</span></code>: made from
<code class="docutils literal notranslate"><span class="pre">{out}/{sample}/mask/ref-2/sect-1/mask-report.json</span></code> and
<code class="docutils literal notranslate"><span class="pre">{out}/{sample}/mask/ref-2/sect-2/mask-report.json</span></code></p></li>
</ul>
<p>To join all valid combinations of Mask/Cluster/Join reports in <code class="docutils literal notranslate"><span class="pre">{out}</span></code> into
sections named <code class="docutils literal notranslate"><span class="pre">{joined}</span></code>, you can use the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">seismic</span> <span class="n">join</span> <span class="o">-</span><span class="n">J</span> <span class="p">{</span><span class="n">joined</span><span class="p">}</span> <span class="p">{</span><span class="n">out</span><span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="join-settings">
<h2>Join: Settings<a class="headerlink" href="#join-settings" title="Permalink to this headline"></a></h2>
<section id="join-setting-name-of-joined-section">
<h3>Join setting: Name of joined section<a class="headerlink" href="#join-setting-name-of-joined-section" title="Permalink to this headline"></a></h3>
<p>You can choose the name of your joined section(s) using <code class="docutils literal notranslate"><span class="pre">--joined</span></code> (<code class="docutils literal notranslate"><span class="pre">-J</span></code>).
If you omit this option in <code class="docutils literal notranslate"><span class="pre">seismic</span> <span class="pre">join</span></code>, then it will default to <code class="docutils literal notranslate"><span class="pre">joined</span></code>.
If you omit this option in <code class="docutils literal notranslate"><span class="pre">seismic</span> <span class="pre">wf</span></code>, then the Join step will not run.</p>
</section>
<section id="join-setting-clusters-to-join">
<h3>Join setting: Clusters to join<a class="headerlink" href="#join-setting-clusters-to-join" title="Permalink to this headline"></a></h3>
<p>When joining cluster reports specifically, you may specify which cluster of each
section should be joined.
For example, if you are joining three sections, each of which you have clustered
up to order 2, then you may want cluster 1 of the joined section to comprise</p>
<ul class="simple">
<li><p>cluster 2 of section 1</p></li>
<li><p>cluster 1 of section 2</p></li>
<li><p>cluster 2 of section 3</p></li>
</ul>
<p>and conversely, cluster 2 of the joined section to comprise</p>
<ul class="simple">
<li><p>cluster 1 of section 1</p></li>
<li><p>cluster 2 of section 2</p></li>
<li><p>cluster 1 of section 3</p></li>
</ul>
<p>You can specify the clusters to join using <code class="docutils literal notranslate"><span class="pre">--join-clusts</span></code> (<code class="docutils literal notranslate"><span class="pre">-j</span></code>) followed
by a file of the clusters to join.
See <a class="reference internal" href="../../formats/meta/joined.html"><span class="doc">Metadata for Joined Clusters</span></a> for more information on this file.</p>
</section>
</section>
<section id="join-output-files">
<h2>Join: Output files<a class="headerlink" href="#join-output-files" title="Permalink to this headline"></a></h2>
<p>All output files go into the directories <code class="docutils literal notranslate"><span class="pre">{out}/{sample}/mask/{ref}/{joined}</span></code>
and/or <code class="docutils literal notranslate"><span class="pre">{out}/{sample}/cluster/{ref}/{joined}</span></code>, where <code class="docutils literal notranslate"><span class="pre">{out}</span></code> is the output
directory, <code class="docutils literal notranslate"><span class="pre">{sample}</span></code> is the sample name, <code class="docutils literal notranslate"><span class="pre">{ref}</span></code> is the reference name,
and <code class="docutils literal notranslate"><span class="pre">{joined}</span></code> is the joined section name.</p>
<section id="join-output-file-join-report">
<h3>Join output file: Join report<a class="headerlink" href="#join-output-file-join-report" title="Permalink to this headline"></a></h3>
<p>SEISMIC-RNA writes a Join report file called either <code class="docutils literal notranslate"><span class="pre">mask-report.json</span></code> or
<code class="docutils literal notranslate"><span class="pre">cluster-report.json</span></code>, depending on whether the joined sections came from Mask
or Cluster reports.
See <a class="reference internal" href="../../formats/report/join.html"><span class="doc">Join Report</span></a> for more information.
The file is named <code class="docutils literal notranslate"><span class="pre">mask-report.json</span></code> or <code class="docutils literal notranslate"><span class="pre">cluster-report.json</span></code> not because
its contents are identical to those of a Mask/Cluster report file (they aren’t)
but because SEISMIC-RNA can more easily use them interchangably when they have
the same file names.
You can give Join reports to the Table step just as you would Mask or Cluster
reports.</p>
</section>
</section>
<section id="join-troubleshoot-and-optimize">
<h2>Join: Troubleshoot and optimize<a class="headerlink" href="#join-troubleshoot-and-optimize" title="Permalink to this headline"></a></h2>
<section id="joined-section-got-duplicate-sections">
<h3>Joined section … got duplicate sections …<a class="headerlink" href="#joined-section-got-duplicate-sections" title="Permalink to this headline"></a></h3>
<p>This warning means that an original (unjoined) section appeared more than once
in the report files you are joining.</p>
<p>For example, suppose that you join <code class="docutils literal notranslate"><span class="pre">section-A</span></code> and <code class="docutils literal notranslate"><span class="pre">section-B</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">seismic</span> <span class="n">join</span> <span class="o">-</span><span class="n">J</span> <span class="n">section</span><span class="o">-</span><span class="n">AB</span> <span class="n">out</span><span class="o">/</span><span class="n">sample</span><span class="o">/</span><span class="n">mask</span><span class="o">/</span><span class="n">ref</span><span class="o">/</span><span class="n">section</span><span class="o">-</span><span class="n">A</span> <span class="n">out</span><span class="o">/</span><span class="n">sample</span><span class="o">/</span><span class="n">mask</span><span class="o">/</span><span class="n">ref</span><span class="o">/</span><span class="n">section</span><span class="o">-</span><span class="n">B</span>
</pre></div>
</div>
<p>Then you try to join <code class="docutils literal notranslate"><span class="pre">section-A</span></code> with the joined section <code class="docutils literal notranslate"><span class="pre">section-AB</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">seismic</span> <span class="n">join</span> <span class="o">-</span><span class="n">J</span> <span class="n">section</span><span class="o">-</span><span class="n">AAB</span> <span class="n">out</span><span class="o">/</span><span class="n">sample</span><span class="o">/</span><span class="n">mask</span><span class="o">/</span><span class="n">ref</span><span class="o">/</span><span class="n">section</span><span class="o">-</span><span class="n">A</span> <span class="n">out</span><span class="o">/</span><span class="n">sample</span><span class="o">/</span><span class="n">mask</span><span class="o">/</span><span class="n">ref</span><span class="o">/</span><span class="n">section</span><span class="o">-</span><span class="n">AB</span>
</pre></div>
</div>
<p>This second command will warn that <code class="docutils literal notranslate"><span class="pre">section-A</span></code> is duplicated because it
appears in both the report files for <code class="docutils literal notranslate"><span class="pre">sample-A</span></code> and <code class="docutils literal notranslate"><span class="pre">pool-1</span></code>.</p>
<p>If you get this warning, then you should check your Pool report file to ensure
it contains all the samples you want and none that you don’t.</p>
</section>
<section id="overwriting-would-cause-data-loss">
<h3>Overwriting … would cause data loss<a class="headerlink" href="#overwriting-would-cause-data-loss" title="Permalink to this headline"></a></h3>
<p>This error means that you attempted to create a joined section with the same
name as an existing non-joined section while using <code class="docutils literal notranslate"><span class="pre">--force</span></code>, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">seismic</span> <span class="n">join</span> <span class="o">--</span><span class="n">force</span> <span class="o">-</span><span class="n">J</span> <span class="n">section</span><span class="o">-</span><span class="n">A</span> <span class="n">out</span>
</pre></div>
</div>
<p>if <code class="docutils literal notranslate"><span class="pre">section-A</span></code> already exists.</p>
<p>Doing so would overwrite the Mask/Cluster report for the original, non-joined
section, making it unusable.
To prevent data loss, the Join step refuses to overwrite Mask/Cluster reports,
even with <code class="docutils literal notranslate"><span class="pre">--force</span></code>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="cluster.html" class="btn btn-neutral float-left" title="Cluster: Infer alternative structures by clustering reads’ mutations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="table.html" class="btn btn-neutral float-right" title="Table: Count mutations for each read and position" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, the Rouskin Lab.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>